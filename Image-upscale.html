<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image Upscaler Pro</title>

<style>
body{
    font-family: Arial;
    text-align:center;
    background:#111;
    color:white;
    padding:20px;
}
.container{
    max-width:600px;
    margin:auto;
    background:#222;
    padding:20px;
    border-radius:10px;
}
button{
    padding:10px 15px;
    margin:5px;
    border:none;
    border-radius:5px;
    cursor:pointer;
    background:#00aaff;
    color:white;
}
button:hover{
    background:#0088cc;
}
img{
    max-width:100%;
    margin-top:15px;
    border-radius:10px;
}
#downloadBtn{
    display:none;
    background:#28a745;
}

/* Progress Bar */
.progress-container{
    width:100%;
    background:#333;
    border-radius:10px;
    margin-top:15px;
    display:none;
}
.progress-bar{
    width:0%;
    height:20px;
    background:#00ff99;
    border-radius:10px;
    transition:width 0.3s;
}
#progressText{
    margin-top:8px;
}
</style>
</head>

<body>

<div class="container">
    <h2>Image Upscaler</h2>

    <input type="file" id="upload" accept="image/*"><br><br>

    <div>
        <button onclick="setResolution(3840)">4K</button>
        <button onclick="setResolution(7680)">8K</button>
        <button onclick="setResolution(15360)">16K</button>
    </div>

    <button onclick="upscaleImage()">Upscale Image</button>

    <!-- Progress -->
    <div class="progress-container" id="progressContainer">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    <div id="progressText"></div>

    <br>
    <img id="preview">

    <br>
    <a id="downloadLink" download="upscaled-image.png">
        <button id="downloadBtn">Download</button>
    </a>
</div>

<script>

let selectedWidth = 3840;
let img = new Image();

// Upload Image
document.getElementById("upload").addEventListener("change", function(event){
    const file = event.target.files[0];
    if(!file) return;

    const reader = new FileReader();
    reader.onload = function(e){
        img.src = e.target.result;
    }
    reader.readAsDataURL(file);
});

img.onload = function(){
    document.getElementById("preview").src = img.src;
}

function setResolution(width){
    selectedWidth = width;
    alert("Selected Resolution: " + width + "px width");
}

function upscaleImage(){

    if(!img.src){
        alert("Please upload image first!");
        return;
    }

    const progressContainer = document.getElementById("progressContainer");
    const progressBar = document.getElementById("progressBar");
    const progressText = document.getElementById("progressText");

    progressContainer.style.display = "block";
    progressBar.style.width = "0%";
    progressText.innerText = "Processing: 0%";

    let progress = 0;

    let interval = setInterval(() => {
        progress += 5;
        progressBar.style.width = progress + "%";
        progressText.innerText = "Upscaling Image: " + progress + "%";

        if(progress >= 100){
            clearInterval(interval);

            // Real Upscale After Animation
            const canvas = document.createElement("canvas");
            const ctx = canvas.getContext("2d");

            let ratio = img.height / img.width;

            canvas.width = selectedWidth;
            canvas.height = selectedWidth * ratio;

            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = "high";

            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

            const upscaledImage = canvas.toDataURL("image/png");

            document.getElementById("preview").src = upscaledImage;

            const downloadBtn = document.getElementById("downloadBtn");
            const downloadLink = document.getElementById("downloadLink");

            downloadLink.href = upscaledImage;
            downloadBtn.style.display = "inline-block";

            progressText.innerText = "âœ… Upscale Complete!";
        }

    }, 100); // Speed Control

}

</script>

</body>
</html>
